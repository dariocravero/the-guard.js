// The Guard.js
// https://github.com/dariocravero/the-guard.js
// (c) 2011 Dar√≠o Javier Cravero
((function(){var a;a=function(){function a(a){this.rules=a,this}return a.prototype.version="0.0.1.a",a.prototype.current_user=null,a.prototype._current_user_roles_hash=null,a.prototype.rules={},a.prototype._can={},a.prototype.can=function(a,b,c){var d,e,f,g,h,i,j;if(this.current_user==null)return!1;e=md5(this.current_user.roles().toString()),this._current_user_roles_hash!==e&&(this._current_user_roles_hash=e,this._can={}),j=this.current_user.roles();for(h=0,i=j.length;h<i;h++)return g=j[h],f=g+"-"+b+"-"+a,_.include(_.keys(this._can),f)?this._can[f]:_.include(_.keys(this.rules),g)&&_.include(_.keys(this.rules[g]),b)&&_.include(_.keys(this.rules[g][b]),a)?(d=!1,_.isFunction(this.rules[g][b][a])?d=this.rules[g][b][a](c,this):_.isBoolean(this.rules[g][b][a])?(d=this.rules[g][b][a],this._can[f]=d):this._can[f]=d,d):this._can[f]=!1;return!1},a}()})).call(this);
